<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: models/character.class.js</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Source: models/character.class.js</h1>

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>/**
 * Class representing the game character.
 * @extends MovableObject
 */
class Character extends MovableObject {
    speed = 10;
    height = 300;
    health = 100;
    y = 130;
    collectedBottles = 0;
    hitCooldown = false;
    isMoving = false;
    jumpCooldown = false;
    lastMoveTime = 0;
    currentImage = 0;

    offset = {
        top: 150,
        left: 30,
        right: 30,
        bottom: 0
    };

    IMAGES_IDLE = [
        'img/2_character_pepe/1_idle/idle/I-1.png',
        'img/2_character_pepe/1_idle/idle/I-2.png',
        'img/2_character_pepe/1_idle/idle/I-3.png',
        'img/2_character_pepe/1_idle/idle/I-4.png',
        'img/2_character_pepe/1_idle/idle/I-5.png',
        'img/2_character_pepe/1_idle/idle/I-6.png',
        'img/2_character_pepe/1_idle/idle/I-7.png',
        'img/2_character_pepe/1_idle/idle/I-8.png',
        'img/2_character_pepe/1_idle/idle/I-9.png'
    ];

    IMAGES_LONG_IDLE = [
        'img/2_character_pepe/1_idle/long_idle/I-11.png',
        'img/2_character_pepe/1_idle/long_idle/I-12.png',
        'img/2_character_pepe/1_idle/long_idle/I-13.png',
        'img/2_character_pepe/1_idle/long_idle/I-14.png',
        'img/2_character_pepe/1_idle/long_idle/I-15.png',
        'img/2_character_pepe/1_idle/long_idle/I-16.png',
        'img/2_character_pepe/1_idle/long_idle/I-17.png',
        'img/2_character_pepe/1_idle/long_idle/I-18.png',
        'img/2_character_pepe/1_idle/long_idle/I-19.png',
        'img/2_character_pepe/1_idle/long_idle/I-20.png'
    ];

    IMAGES_WALKING = [
        'img/2_character_pepe/2_walk/W-21.png',
        'img/2_character_pepe/2_walk/W-22.png',
        'img/2_character_pepe/2_walk/W-23.png',
        'img/2_character_pepe/2_walk/W-24.png',
        'img/2_character_pepe/2_walk/W-25.png',
        'img/2_character_pepe/2_walk/W-26.png'
    ];

    IMAGES_JUMPING = [
        'img/2_character_pepe/3_jump/J-31.png',
        'img/2_character_pepe/3_jump/J-32.png',
        'img/2_character_pepe/3_jump/J-33.png',
        'img/2_character_pepe/3_jump/J-34.png',
        'img/2_character_pepe/3_jump/J-35.png',
        'img/2_character_pepe/3_jump/J-36.png',
        'img/2_character_pepe/3_jump/J-37.png',
        'img/2_character_pepe/3_jump/J-38.png',
        'img/2_character_pepe/3_jump/J-39.png'
    ];

    IMAGES_HURT = [
        'img/2_character_pepe/4_hurt/H-41.png',
        'img/2_character_pepe/4_hurt/H-42.png',
        'img/2_character_pepe/4_hurt/H-43.png'
    ];

    IMAGES_DEAD = [
        'img/2_character_pepe/5_dead/D-51.png',
        'img/2_character_pepe/5_dead/D-52.png',
        'img/2_character_pepe/5_dead/D-53.png',
        'img/2_character_pepe/5_dead/D-54.png',
        'img/2_character_pepe/5_dead/D-55.png',
        'img/2_character_pepe/5_dead/D-56.png',
        'img/2_character_pepe/5_dead/D-57.png'
    ];

    /**
     * Creates an instance of Character.
     */
    constructor() {
        super().loadImage('img/2_character_pepe/2_walk/W-21.png');
        this.loadImages(this.IMAGES_IDLE);
        this.loadImages(this.IMAGES_LONG_IDLE);
        this.loadImages(this.IMAGES_WALKING);
        this.loadImages(this.IMAGES_JUMPING);
        this.loadImages(this.IMAGES_HURT);
        this.loadImages(this.IMAGES_DEAD);
        this.applyGravity();
        this.x = 100;
        this.animate();
    }

    /**
     * Initiates the character's animations and movement handling.
     */
    animate() {
        this.handleMovement();
        this.handleAnimation();
        this.setIdle();
        this.longIdle();
    }

    /**
     * Sets the character's animation to idle.
     */
    setIdle() {
        this.playAnimation(this.IMAGES_IDLE);
    }

    /**
     * Sets the character's animation to long idle if conditions are met.
     */
    longIdle() { 
        let longIdleInterval = 1000;
        setInterval(() => {
            if (!this.isMoving &amp;&amp; !this.isAboveGround() &amp;&amp; !this.isHurt() &amp;&amp; !this.isDead() &amp;&amp; (Date.now() - this.lastMoveTime > 5000)) {
                this.playAnimation(this.IMAGES_LONG_IDLE);
            }
        }, longIdleInterval);
    }

    /**
     * Handles the character's movement based on keyboard input.
     */
    handleMovement() {
        setInterval(() => {
            this.resetMovement();
            this.handleRightMovement();
            this.handleLeftMovement();
            this.handleJump();
            this.updateCamera();
        }, 1000 / 60);
    }

    /**
     * Resets the character's movement.
     */
    resetMovement() {
        audioManager.pause('walking');
        this.isMoving = false;
    }

    /**
     * Handles the character's right movement.
     */
    handleRightMovement() {
        if (this.world.keyboard.RIGHT &amp;&amp; this.x &lt; this.world.level.level_end_x) {
            this.moveRight();
            this.otherDirection = false;
            audioManager.play('walking');
            this.world.updateBackground();
            this.isMoving = true;
            this.lastMoveTime = Date.now();
        }
    }

    /**
     * Handles the character's left movement.
     */
    handleLeftMovement() {
        if (this.world.keyboard.LEFT &amp;&amp; this.x > 0) {
            this.moveLeft();
            this.otherDirection = true;
            audioManager.play('walking');
            this.world.updateBackground();
            this.isMoving = true;
            this.lastMoveTime = Date.now();
        }
    }

    /**
     * Handles the character's jump action.
     */
    handleJump() {
        if (this.world.keyboard.SPACE &amp;&amp; !this.isAboveGround() &amp;&amp; !this.jumpCooldown) {
            this.jump();
            this.lastMoveTime = Date.now();
        }
    }

    /**
     * Updates the camera position based on the character's position.
     */
    updateCamera() {
        this.world.camera_x = -this.x + 100;
    }

    /**
     * Handles the character's animation based on its state.
     */
    handleAnimation() {
        setInterval(() => {
            if (this.isDead()) {
                this.playAnimation(this.IMAGES_DEAD);
            } else if (this.isHurt() &amp;&amp; !this.isAboveGround()) {
                this.playAnimation(this.IMAGES_HURT);
            } else if (this.isAboveGround()) {
                this.playAnimation(this.IMAGES_JUMPING);
            } else if (this.isMoving) {
                this.playAnimation(this.IMAGES_WALKING);
            } else {
                this.playAnimation(this.IMAGES_IDLE);
            }
        }, 50);
    }

    /**
     * Makes the character jump.
     */
    jump() {
        this.speedY = 25;
        this.isMoving = true;
        this.jumpCooldown = true;

        setTimeout(() => {
            this.jumpCooldown = false;
        }, 500);
    }

    /**
     * Checks if the character is above ground.
     * @returns {boolean} - True if the character is above ground, false otherwise.
     */
    isAboveGround() {
        return this.y &lt; 130;
    }

    /**
     * Handles the character getting hit.
     */
    hit() {
        if (this.isAboveGround() || this.hitCooldown) return;
        this.reduceHealth(5); 

        if (this.health &lt;= 0) {
            this.die();
        } else {
            this.activateHitCooldown(1000);
        }
    }

    /**
     * Reduces the character's health by the specified amount.
     * @param {number} amount - The amount to reduce the health by.
     */
    reduceHealth(amount) {
        this.health -= amount;
        if (this.health &lt; 0) {
            this.health = 0;
        }
        this.world.statusBarHealth.setPercentage(this.health);
    }

    /**
     * Activates the hit cooldown for the specified duration.
     * @param {number} duration - The duration of the hit cooldown in milliseconds.
     */
    activateHitCooldown() {
        this.hitCooldown = true;
        this.lastHit = Date.now();
        setTimeout(() => {
            this.hitCooldown = false;
        }, 1000);
    }

    /**
     * Handles the character dying.
     */
    die() {
        if (this.isDead()) return;
        this.health = 0;
        this.playAnimation(this.IMAGES_DEAD); 
        setTimeout(() => {
            this.remove();
        }, 500);
        this.world.statusBarHealth.setPercentage(this.health);
        if (!this.world.lostGame &amp;&amp; !this.world.winGame) {
            this.world.lostGame = true;
            this.world.gameOver = true;
            window.lostGame();
        }
    }

    /**
     * Checks if the character is dead.
     * @returns {boolean} - True if the character is dead, false otherwise.
     */
    isDead() {
        return this.health &lt;= 0;
    }

    /**
     * Removes the character from the game world.
     */
    remove() {
        this.world.character = null;
    }
}
</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Classes</h3><ul><li><a href="AudioManager.html">AudioManager</a></li><li><a href="BackgroundObject.html">BackgroundObject</a></li><li><a href="Bottle.html">Bottle</a></li><li><a href="Character.html">Character</a></li><li><a href="Chicken.html">Chicken</a></li><li><a href="ChickenSmall.html">ChickenSmall</a></li><li><a href="Cloud.html">Cloud</a></li><li><a href="Coins.html">Coins</a></li><li><a href="CollisionManager.html">CollisionManager</a></li><li><a href="DrawableObject.html">DrawableObject</a></li><li><a href="Endboss.html">Endboss</a></li><li><a href="Keyboard.html">Keyboard</a></li><li><a href="Level.html">Level</a></li><li><a href="MovableObject.html">MovableObject</a></li><li><a href="StatusBar.html">StatusBar</a></li><li><a href="ThrowableObject.html">ThrowableObject</a></li><li><a href="World.html">World</a></li></ul><h3>Global</h3><ul><li><a href="global.html#muteSound">muteSound</a></li></ul>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc/jsdoc">JSDoc 4.0.3</a> on Thu Jul 18 2024 10:21:18 GMT+0200 (Mitteleuropäische Sommerzeit)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
